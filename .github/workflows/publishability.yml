name: Publishability

on:
  push:
    # Ignore commits created by bors
    branches-ignore:
      - 'staging'
      - 'trying'
  pull_request:
    branches-ignore:
      - 'staging'
      - 'trying'

env:
  RUST_MIN_STACK: 16777216
  CARGO_INCREMENTAL: 0
  CI: "1"

jobs:
  stable:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2

      - name: Check swc_atoms
        run: (cd atoms && cargo +stable publish --dry-run)

      - name: Check swc_common
        run: (cd common && cargo +stable publish --dry-run)

#      - name: Check swc_ecma_ast
#        run: (cd ecmascript/ast && cargo +stable publish --dry-run)
#
#      - name: Check swc_ecma_parser
#        run: (cd ecmascript/parser && cargo +stable publish --dry-run)
#
#      - name: Check swc_ecma_codegen
#        run: (cd ecmascript/codegen && cargo +stable publish --dry-run)
#
#      - name: Check swc_ecma_utils (nightly only)
#        run: (cd ecmascript/utils && cargo publish --dry-run)
#
#      - name: Check swc_ecma_transforms (nightly only)
#        run: (cd ecmascript/utils && cargo publish --dry-run)
